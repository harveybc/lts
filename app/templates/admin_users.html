{% extends "base.html" %}
{% block title %}Admin - Users{% endblock %}
{% block nav_admin_users %}active{% endblock %}
{% block page_title %}User Management{% endblock %}
{% block content %}
<div class="card">
  <div class="card-header"><h3 class="card-title">All Users</h3></div>
  <div class="card-body p-0">
    <table class="table table-striped">
      <thead><tr><th>ID</th><th>Username</th><th>Email</th><th>Role</th><th>Active</th></tr></thead>
      <tbody id="user-list"><tr><td colspan="5" class="text-center text-muted">Loading...</td></tr></tbody>
    </table>
  </div>
</div>
{% endblock %}
{% block extra_js %}
<script>
async function pageInit() {
  var u = getUserInfo();
  if (u.role !== 'admin') { flash('Admin access required','error'); return; }
  var r = await apiFetch('/api/users');
  if (!r || !r.ok) return;
  var data = await r.json();
  var tb = document.getElementById('user-list');
  tb.innerHTML = '';
  data.forEach(function(u){
    tb.innerHTML += '<tr><td>'+u.id+'</td><td>'+u.username+'</td><td>'+u.email+'</td><td><span class="badge badge-primary">'+u.role+'</span></td><td>'+(u.is_active?'<span class="badge badge-success">Yes</span>':'<span class="badge badge-danger">No</span>')+'</td></tr>';
  });
}
</script>
{% endblock %}

{% extends "base.html" %}
{% block title %}Trades{% endblock %}
{% block nav_trades %}active{% endblock %}
{% block page_title %}Trade History{% endblock %}
{% block content %}
<div class="card">
  <div class="card-header"><h3 class="card-title">All Trades</h3></div>
  <div class="card-body p-0">
    <table class="table table-striped table-hover">
      <thead><tr><th>Date</th><th>Symbol</th><th>Direction</th><th>Entry</th><th>Exit</th><th>P&amp;L</th><th>Status</th></tr></thead>
      <tbody id="trades-list"><tr><td colspan="7" class="text-center text-muted">Loading...</td></tr></tbody>
    </table>
  </div>
</div>
{% endblock %}
{% block extra_js %}
<script>
async function pageInit() {
  var r = await apiFetch('/api/orders');
  if (!r || !r.ok) return;
  var data = await r.json();
  var tb = document.getElementById('trades-list');
  if (!data.length) { tb.innerHTML = '<tr><td colspan="7" class="text-center text-muted">No trades yet</td></tr>'; return; }
  tb.innerHTML = '';
  data.forEach(function(o){
    tb.innerHTML += '<tr><td>'+(o.created_at||'-')+'</td><td>'+o.symbol+'</td><td>'+o.order_type+'</td><td>'+(o.price||'-')+'</td><td>'+(o.filled_price||'-')+'</td><td>'+(o.pnl||'-')+'</td><td><span class="badge badge-'+(o.status==='filled'?'success':'secondary')+'">'+o.status+'</span></td></tr>';
  });
}
</script>
{% endblock %}
